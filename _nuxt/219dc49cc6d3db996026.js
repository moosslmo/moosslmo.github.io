(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{695:function(e,t,r){var content=r(701);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(105).default)("72541fd0",content,!0,{sourceMap:!1})},700:function(e,t,r){"use strict";var n=r(695);r.n(n).a},701:function(e,t,r){(e.exports=r(104)(!1)).push([e.i,".user[data-v-141c844f]{display:grid}.user__message[data-v-141c844f]{position:absolute;display:inline-block;-webkit-transform-origin:bottom center;transform-origin:bottom center;-webkit-transform:translateX(-50%) translateY(calc(-100% - 58px));transform:translateX(-50%) translateY(calc(-100% - 58px));background-color:#ddd;border-radius:8px;padding:4px 8px;max-width:150px}.user__message.new[data-v-141c844f]{-webkit-animation:popup-data-v-141c844f .15s cubic-bezier(.175,.885,.32,1.275);animation:popup-data-v-141c844f .15s cubic-bezier(.175,.885,.32,1.275)}.user__avatar[data-v-141c844f]{position:absolute;cursor:none;border-radius:100%}.user__name[data-v-141c844f]{position:absolute;-webkit-transform:translateX(-50%) translateY(55px);transform:translateX(-50%) translateY(55px)}@-webkit-keyframes popup-data-v-141c844f{0%{-webkit-transform:scale(0) translateX(-50%) translateY(calc(-100% - 58px));transform:scale(0) translateX(-50%) translateY(calc(-100% - 58px))}to{-webkit-transform:scale(1) translateX(-50%) translateY(calc(-100% - 58px));transform:scale(1) translateX(-50%) translateY(calc(-100% - 58px))}}@keyframes popup-data-v-141c844f{0%{-webkit-transform:scale(0) translateX(-50%) translateY(calc(-100% - 58px));transform:scale(0) translateX(-50%) translateY(calc(-100% - 58px))}to{-webkit-transform:scale(1) translateX(-50%) translateY(calc(-100% - 58px));transform:scale(1) translateX(-50%) translateY(calc(-100% - 58px))}}",""])},702:function(e,t,r){"use strict";var n={props:["message","x","y","avatar","name","face","isFace"],data:function(){return{width:100}},watch:{message:function(e){var t=this;this.$refs.message&&this.$refs.message.classList.add("new"),setTimeout(function(){return t.$refs.message.classList.remove("new")},150)}}},c=(r(700),r(70));Object(c.a)(n,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user"},[e.message?r("div",{ref:"message",staticClass:"user__message",style:{left:e.x+"px",top:e.y+"px"}},[e._v("\n    "+e._s(e.message)+"\n  ")]):e._e(),e._v(" "),r("img",{staticClass:"user__avatar",style:{left:e.x-e.width/2+"px",top:e.y-e.width/2+"px"},attrs:{src:e.isFace?e.face:e.avatar,width:e.width}}),e._v(" "),r("div",{staticClass:"user__name",style:{left:e.x+"px",top:e.y+"px"}},[e._v("\n    "+e._s(e.name)+"\n  ")])])},[],!1,null,"141c844f",null).exports},705:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return c});var n=5e3,c=2500},736:function(e,t,r){var content=r(874);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(105).default)("6a8c5b2e",content,!0,{sourceMap:!1})},743:function(e,t){},744:function(e,t){},762:function(e,t){},765:function(e,t){},873:function(e,t,r){"use strict";var n=r(736);r.n(n).a},874:function(e,t,r){(e.exports=r(104)(!1)).push([e.i,".container[data-v-3a01795c]{height:100%;width:100%;display:grid;background-color:#000;overflow-x:hidden;position:relative;background-image:url(/background-2.gif);background-size:70%}.container .camera[data-v-3a01795c]{justify-self:center;align-self:center}.container .camera canvas[data-v-3a01795c]{display:block;border-radius:100%;border:6px solid #f2c94c}.container .camera video[data-v-3a01795c]{display:block;position:absolute;background-color:rgba(0,0,0,.1);visibility:hidden}.container .board[data-v-3a01795c]{position:absolute;justify-self:center;align-self:end;margin-bottom:30px}.container .board .ranking[data-v-3a01795c]{display:grid;grid-auto-flow:column;grid-template-columns:26px 1fr 86px;font-family:Open Sans;margin-top:8px;height:20px}.container .board .ranking .rank[data-v-3a01795c]{text-align:center;color:#fff;background-color:#ffc338;border-radius:6px}.container .board .ranking .name[data-v-3a01795c],.container .board .ranking .rank[data-v-3a01795c]{font-style:normal;font-weight:700;font-size:14px;line-height:19px;align-items:center;margin-left:6px}.container .board .ranking .name[data-v-3a01795c]{letter-spacing:-.06em;color:#dad9d9}.container .board .ranking .score[data-v-3a01795c]{background-color:#f2f2f2;border-radius:6px;font-style:normal;font-weight:700;font-size:14px;line-height:19px;align-items:center;text-align:center;color:#000a15;margin-right:6px}@-webkit-keyframes popup-data-v-3a01795c{0%{-webkit-transform:scale(0);transform:scale(0)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes popup-data-v-3a01795c{0%{-webkit-transform:scale(0);transform:scale(0)}to{-webkit-transform:scale(1);transform:scale(1)}}@-webkit-keyframes popdown-data-v-3a01795c{0%{-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:scale(0);transform:scale(0)}}@keyframes popdown-data-v-3a01795c{0%{-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:scale(0);transform:scale(0)}}",""])},883:function(e,t,r){"use strict";r.r(t);var n=r(780),c=r(48),o=(r(146),r(35)),l=r(147),f=(r(702),r(779)),d=(r(705),{data:function(){return{uid:null,me:null,inputText:"",isInputFocus:!1,isFace:!1,timer:null,key:"",faceInterval:null,scoreInterval:null,manager:null,startX:0,startY:0,width:150}},firebase:function(){return{users:l.a.ref("users")}},mounted:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.key=this.$route.query.key,e.next=3,l.a.ref("users/".concat(t)).once("value");case 3:if(e.sent.val()){e.next=7;break}return this.$router.push("/"),e.abrupt("return");case 7:return this.$bindAsObject("user",l.a.ref("users/".concat(t))),this.score=0,this.highScore=0,this.outCount=0,window.addEventListener("beforeunload",function(e){l.a.ref("users/".concat(t)).set({}),clearInterval(r.faceInterval),clearInterval(r.scoreInterval)}),e.next=14,f.c.tinyFaceDetector.loadFromUri("/models");case 14:this.cameraOn();case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),unmount:function(){clearInterval(this.faceInterval),clearInterval(this.scoreInterval),l.a.ref("users/".concat(this.key)).set({})},methods:{cameraOn:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var video,t,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return video=this.$refs.video,e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 4:t=e.sent,t.getVideoTracks(),video.onloadedmetadata=function(e){return video.play()},video.srcObject=t,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:this.faceInterval=setInterval(function(){r.detectFace()},16),this.scoreInterval=setInterval(function(){r.score+=.5,r.score>r.highScore&&(r.highScore=r.score,l.a.ref("users/".concat(r.key,"/highScore")).set(r.highScore)),l.a.ref("users/".concat(r.key,"/score")).set(r.score)},100);case 15:case"end":return e.stop()}},e,this,[[1,10]])}));return function(){return e.apply(this,arguments)}}(),detectFace:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t,r,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.b(this.$refs.video,new f.a({inputSize:224}));case 2:(t=e.sent)?(this.outCount=0,this.setUserFace(t)):(++this.outCount,this.outCount>15&&(this.score>1?(r=Math.floor(this.score/100)>2?Math.floor(this.score/100):2,this.score-=r,0!==this.users.filter(function(e){return e[".key"]===n.key}).length&&l.a.ref("users/".concat(this.key,"/score")).set(this.score)):l.a.ref("users/".concat(this.key,"/highScore")).set(this.highScore)));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),setUserFace:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(t){var r,n,c,o,f,d,h,m,v,k,x=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.box,n=this.$refs.userFace,c=n.getContext("2d"),o=r.width/5,f=r.left-o,d=r.top-1.5*o,h=r.width+2*o,m=r.height+2*o,h>m&&(v=m-h,m=h,d+=v/2),k=this.score<100?Math.floor(150+this.score):250,this.width=k,c.drawImage(this.$refs.video,f,d,h,m,0,0,200,200),0!==this.users.filter(function(e){return e[".key"]===x.key}).length&&l.a.ref("users/".concat(this.key,"/faceImage")).set(n.toDataURL("image/jpeg",.1));case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},computed:{userList:function(){var e=this;return this.users.filter(function(t){return t[".key"]!==e.key}).filter(function(e){return e.faceImage}).map(function(e){var t=Object(c.a)({},e);return delete t[".key"],t})},userRankList:function(){return Object(n.a)(this.users).filter(function(e){return e.x}).sort(function(a,b){return b.score-a.score}).slice(0,5)}},components:{}}),h=(r(873),r(70)),component=Object(h.a)(d,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",{staticClass:"camera"},[r("video",{ref:"video",attrs:{autoplay:"",playsinline:"",width:"480",height:"360"}}),e._v(" "),r("canvas",{ref:"userFace",staticClass:"face",attrs:{id:"userFace",width:200,height:200}})]),e._v(" "),r("div",{staticClass:"board"},[r("img",{attrs:{src:"/leaderboard.svg"}}),e._v(" "),e._l(e.userRankList,function(t,i){return r("div",{key:i,staticClass:"ranking"},[r("div",{staticClass:"rank"},[e._v(e._s(i+1))]),e._v(" "),r("div",{staticClass:"name"},[e._v(e._s(t.name))]),e._v(" "),r("div",{staticClass:"score"},[e._v(e._s(Math.floor(t.score)))])])})],2)])},[],!1,null,"3a01795c",null);t.default=component.exports}}]);